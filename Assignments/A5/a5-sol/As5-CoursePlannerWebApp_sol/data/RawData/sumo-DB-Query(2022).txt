

2022 sumo used the query below.
- Problem? Does it double count a class if it was taught by 2 instructors (is it listed twice?)


SELECT
  PCTTMP.STRM,
  CONCAT(
    CASE WHEN RIGHT(PCTTMP.STRM,1)='1' THEN 'Spring '
       WHEN RIGHT(PCTTMP.STRM,1)='4' THEN 'Summer '
       WHEN RIGHT(PCTTMP.STRM,1)='7' THEN 'Fall '
       ELSE 'TERM '
    END,
    CAST( (CAST(LEFT(PCTTMP.STRM,3) AS INT) + 1900) AS VARCHAR)
  ) AS STRM_STR,
  PCTTMP.SUBJECT,  PCTTMP.CATALOG_NBR,  PCTTMP.CLASS_SECTION,
  PCTTMP.SSR_COMPONENT,
  PCTTMP.ACAD_CAREER,  PCTTMP.ACAD_ORG, PCTTMP.CAMPUS,
  PCTTMP.ENRL_CAP, PCTTMP.ENRL_TOT,
  PCITMP.INSTR_NAME
FROM (
SELECT
  PCT.STRM,
  PCT.CRSE_ID, PCT.SUBJECT, PCT.CATALOG_NBR, PCT.CLASS_SECTION,
  PCT.SSR_COMPONENT,
  PCT.ACAD_CAREER, PCT.ACAD_ORG, PCT.CAMPUS,
  PCT.ENRL_CAP,
  PCT.ENRL_TOT
 FROM PS_CLASS_TBL PCT
WHERE ( STRM > '1177' AND STRM < '1227' )
  AND CANCEL_DT IS NULL
) PCTTMP
LEFT JOIN
(
SELECT INSTR_NAME, CRSE_ID, CLASS_SECTION, STRM
  FROM (
      SELECT DISTINCT PCI.EMPLID, CRSE_ID, CLASS_SECTION, STRM, NAME_DISPLAY AS INSTR_NAME
        FROM PS_CLASS_INSTR PCI,
             PS_PERSONAL_DATA PPD
       WHERE ( STRM > '1177' AND STRM < '1227' )
         AND INSTR_ROLE='PI'
         AND PCI.EMPLID=PPD.EMPLID
  ) EMPLIDLIST
) PCITMP
 ON PCTTMP.STRM=PCITMP.STRM
AND PCTTMP.CRSE_ID=PCITMP.CRSE_ID
AND PCTTMP.CLASS_SECTION=PCITMP.CLASS_SECTION
ORDER BY PCTTMP.STRM, PCTTMP.SUBJECT, PCTTMP.CATALOG_NBR, PCTTMP.CLASS_SECTION
